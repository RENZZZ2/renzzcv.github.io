<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Converter Tool</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>CV BY RENZZ 500K TOOLS NEED LANGSUNG AJA PM TELE @SKYRENZZ</h1>
        </header>
        <main>
            <!-- Konversi TXT ke VCF -->
<section class="file-section">
    <h2>Konversi TXT ke VCF</h2>
    <input type="file" id="txt-file" accept=".txt" multiple>
    <input type="text" id="contact-name" placeholder="Nama Kontak" required>
    <input type="number" id="contact-count" placeholder="Jumlah Kontak per File" required>
    <input type="text" id="vcf-file-name" placeholder="Nama File VCF" required>
    <input type="number" id="start-number" placeholder="Nomor Awal" required> <!-- Input untuk nomor awal -->
    <button onclick="convertTxtToVcf()">Konversi</button>
    <p id="file-info"></p>
</section>

<!-- Split File VCF -->
<section class="file-section">
    <h2>Pecah File VCF</h2>
    <input type="file" id="vcf-split-file" accept=".vcf">
    <input type="number" id="split-count" placeholder="Jumlah Kontak per File" required>
    <input type="text" id="split-file-name" placeholder="Nama File VCF" required>
    <input type="number" id="split-start-number" placeholder="Nomor Awal" required> <!-- Input untuk nomor awal -->
    <button onclick="splitVcfFile()">Pecah</button>
    <p id="vcf-split-info"></p>
</section>


            <!-- Gabungkan File TXT -->
            <section class="file-section">
                <h2>Gabungkan File TXT</h2>
                <input type="file" id="merge-files" accept=".txt" multiple>
                <input type="text" id="merged-file-name" placeholder="Nama File Gabungan" required>
                <button onclick="mergeTxtFiles()">Gabungkan</button>
                <p id="merge-file-info"></p>
            </section>

            <!-- Konversi VCF ke TXT -->
            <section class="file-section">
                <h2>Konversi VCF ke TXT</h2>
                <input type="file" id="vcf-files" accept=".vcf" multiple>
                <input type="text" id="txt-file-name" placeholder="Nama File TXT" required>
                <button onclick="convertVcfToTxt()">Konversi</button>
                <p id="vcf-to-txt-info"></p>
            </section>

            <!-- Konversi PDF ke Word -->
            <section class="file-section">
                <h2>Konversi PDF ke Word</h2>
                <input type="file" id="pdf-file" accept=".pdf">
                <input type="text" id="word-file-name" placeholder="Nama File Word" required>
                <button onclick="convertPdfToWord()">Konversi</button>
                <p id="pdf-to-word-info"></p>
            </section>

            <!-- Konversi Word ke PDF -->
            <section class="file-section">
                <h2>Konversi Word ke PDF</h2>
                <input type="file" id="word-file" accept=".doc,.docx">
                <input type="text" id="pdf-output-name" placeholder="Nama File PDF" required>
                <button onclick="convertWordToPdf()">Konversi</button>
                <p id="word-to-pdf-info"></p>
            </section>

           

            <!-- Ganti Nama Kontak di VCF -->
            <section class="file-section">
                <h2>Ganti Nama Kontak di VCF</h2>
                <input type="file" id="vcf-edit-file" accept=".vcf">
                <input type="text" id="old-contact-name" placeholder="Nama Kontak Lama" required>
                <input type="text" id="new-contact-name" placeholder="Nama Kontak Baru" required>
                <input type="text" id="edit-file-name" placeholder="Nama File VCF" required>
                <button onclick="editVcfContactName()">Ganti Nama</button>
                <p id="vcf-edit-info"></p>
            </section>

            <!-- File yang Diupload -->
            <section class="file-section">
                <h2>File yang Diupload</h2>
                <div id="uploaded-files" class="file-list"></div>
            </section>
        </main>
    </div>
    <script>
        let uploadedFiles = [];
        let fileInputIdMap = {
            'txt-file': 'txt-file',
            'merge-files': 'merge-files',
            'vcf-files': 'vcf-files',
            'pdf-file': 'pdf-file',
            'word-file': 'word-file',
            'vcf-split-file': 'vcf-split-file',
            'vcf-edit-file': 'vcf-edit-file'
        };

        // Fungsi untuk menampilkan daftar file yang diunggah
        function displayUploadedFiles() {
            const uploadedFilesContainer = document.getElementById('uploaded-files');
            uploadedFilesContainer.innerHTML = ''; // Kosongkan daftar sebelum memperbarui

            uploadedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.classList.add('file-item');
                fileItem.textContent = file.name;

                const removeButton = document.createElement('button');
                removeButton.textContent = 'Hapus';
                removeButton.onclick = () => removeFile(index);

                fileItem.appendChild(removeButton);
                uploadedFilesContainer.appendChild(fileItem);
            });
        }

        // Fungsi untuk menghapus file dari daftar
        function removeFile(index) {
            uploadedFiles.splice(index, 1); // Hapus file dari array
            displayUploadedFiles(); // Perbarui daftar tampilan
        }

        // Fungsi untuk menambahkan file ke array uploadedFiles dan menampilkannya
        function handleFileInput(event) {
            const inputId = event.target.id;
            const files = Array.from(event.target.files);
            uploadedFiles = uploadedFiles.filter(file => !files.includes(file)); // Hapus file yang sudah ada
            uploadedFiles.push(...files); // Tambah file baru
            displayUploadedFiles(); // Tampilkan file yang diunggah
        }

        // Event listeners untuk file inputs
        for (const [key, id] of Object.entries(fileInputIdMap)) {
            document.getElementById(id).addEventListener('change', handleFileInput);
        }

        function convertTxtToVcf() {
    const fileInput = document.getElementById('txt-file');
    const contactName = document.getElementById('contact-name').value;
    const vcfFileName = document.getElementById('vcf-file-name').value;
    const contactCount = parseInt(document.getElementById('contact-count').value, 10);
    const startNumber = parseInt(document.getElementById('start-number').value, 10); // Ambil nomor awal
    const fileInfo = document.getElementById('file-info');

    if (fileInput.files.length === 0) {
        alert('Silakan pilih file TXT terlebih dahulu.');
        return;
    }
    if (!contactName || !vcfFileName || isNaN(contactCount) || contactCount <= 0 || isNaN(startNumber)) {
        alert('Silakan masukkan nama kontak, nama file VCF, jumlah kontak per file, dan nomor awal yang valid.');
        return;
    }

    const files = fileInput.files;
    let allContacts = [];
    let filesRead = 0;

    const readFile = (file) => {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();

            reader.onload = function(event) {
                const lines = event.target.result.split('\n').filter(line => line.trim() !== '');
                lines.forEach(line => {
                    const contactNumber = line.trim().replace(/[^0-9]/g, '');
                    const formattedNumber = contactNumber.startsWith('+') ? contactNumber : `+${contactNumber}`;
                    allContacts.push(formattedNumber);
                });
                filesRead++;
                resolve();
            };

            reader.onerror = function(error) {
                reject('Terjadi kesalahan saat membaca file:', error);
            };

            reader.readAsText(file);
        });
    };

    const processFiles = async () => {
        try {
            for (const file of files) {
                await readFile(file);
            }

            if (allContacts.length === 0) {
                fileInfo.textContent = 'Tidak ada kontak ditemukan dalam file.';
                return;
            }

            const totalFiles = Math.ceil(allContacts.length / contactCount);
            fileInfo.textContent = `Total file VCF yang akan diunduh: ${totalFiles}`;

            let fileIndex = startNumber; // Mulai dengan nomor awal
            for (let i = 0; i < totalFiles; i++) {
                const startIndex = i * contactCount;
                const endIndex = Math.min(startIndex + contactCount, allContacts.length);
                const contactsChunk = allContacts.slice(startIndex, endIndex);
                let vcfFileContent = '';

                contactsChunk.forEach((contact, index) => {
                    vcfFileContent += `BEGIN:VCARD\nVERSION:3.0\nFN:${contactName} ${startIndex + index + 1}\nTEL:${contact}\nEND:VCARD\n`;
                });

                // Gunakan setTimeout untuk memastikan unduhan file tidak tumpang tindih
                await new Promise(resolve => setTimeout(resolve, 100)); // Delay 100ms untuk setiap file

                const vcfBlob = new Blob([vcfFileContent], { type: 'text/vcard' });
                const vcfUrl = URL.createObjectURL(vcfBlob);
                const link = document.createElement('a');
                link.href = vcfUrl;
                link.download = `${vcfFileName}_${fileIndex++}.vcf`; // Gunakan nomor awal dan increment
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(vcfUrl);

                console.log(`Downloaded file: ${vcfFileName}_${fileIndex - 1}.vcf`);
            }

            fileInfo.textContent = 'Konversi selesai. Semua file VCF telah diunduh.';
        } catch (error) {
            console.error(error);
            fileInfo.textContent = 'Terjadi kesalahan saat konversi.';
        }
    };

    processFiles();
}

        // Fungsi untuk menggabungkan file TXT
        // Fungsi untuk menggabungkan file TXT
function mergeTxtFiles() {
    const fileInput = document.getElementById('merge-files');
    const mergedFileName = document.getElementById('merged-file-name').value;
    const mergeFileInfo = document.getElementById('merge-file-info');

    if (fileInput.files.length === 0) {
        alert('Silakan pilih file TXT terlebih dahulu.');
        return;
    }
    if (!mergedFileName) {
        alert('Silakan masukkan nama file gabungan.');
        return;
    }

    let mergedContent = '';
    const files = Array.from(fileInput.files);
    let totalFilesProcessed = 0;

    files.forEach((file, index) => {
        const reader = new FileReader();

        reader.onload = function(event) {
            mergedContent += event.target.result + '\n';

            totalFilesProcessed++;
            // Jika semua file sudah diproses, buat dan unduh file gabungan
            if (totalFilesProcessed === files.length) {
                const mergedBlob = new Blob([mergedContent], { type: 'text/plain' });
                const mergedUrl = URL.createObjectURL(mergedBlob);
                const link = document.createElement('a');
                link.href = mergedUrl;
                link.download = `${mergedFileName}.txt`;
                link.click();
                URL.revokeObjectURL(mergedUrl);
                mergeFileInfo.textContent = 'Penggabungan selesai.';
            }
        };

        reader.readAsText(file);
    });
}



        // Fungsi untuk mengonversi VCF ke TXT
        function convertVcfToTxt() {
            const fileInput = document.getElementById('vcf-files');
            const txtFileName = document.getElementById('txt-file-name').value;
            const vcfToTxtInfo = document.getElementById('vcf-to-txt-info');

            if (fileInput.files.length === 0) {
                alert('Silakan pilih file VCF terlebih dahulu.');
                return;
            }
            if (!txtFileName) {
                alert('Silakan masukkan nama file TXT.');
                return;
            }

            let txtContent = '';
            const files = fileInput.files;
            let totalFilesProcessed = 0;

            for (const file of files) {
                const reader = new FileReader();

                reader.onload = function(event) {
                    const vcfContent = event.target.result;
                    const contacts = vcfContent.split('END:VCARD').filter(card => card.trim() !== '');

                    contacts.forEach(contact => {
                        const telMatch = contact.match(/TEL:\+([\d]+)/);
                        if (telMatch) {
                            txtContent += telMatch[1] + '\n';
                        }
                    });

                    totalFilesProcessed++;
                    if (totalFilesProcessed === files.length) {
                        const txtBlob = new Blob([txtContent], { type: 'text/plain' });
                        const txtUrl = URL.createObjectURL(txtBlob);
                        const link = document.createElement('a');
                        link.href = txtUrl;
                        link.download = `${txtFileName}.txt`;
                        link.click();
                        URL.revokeObjectURL(txtUrl);
                        vcfToTxtInfo.textContent = 'Konversi selesai.';
                    }
                };

                reader.readAsText(file);
            }
        }

        // Fungsi untuk mengonversi PDF ke Word
        function convertPdfToWord() {
            const fileInput = document.getElementById('pdf-file');
            const wordFileName = document.getElementById('word-file-name').value;
            const pdfToWordInfo = document.getElementById('pdf-to-word-info');

            if (fileInput.files.length === 0) {
                alert('Silakan pilih file PDF terlebih dahulu.');
                return;
            }
            if (!wordFileName) {
                alert('Silakan masukkan nama file Word.');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(event) {
                // Simulasi konversi PDF ke Word
                const pdfBlob = event.target.result;
                const wordBlob = new Blob([pdfBlob], { type: 'application/msword' });
                const wordUrl = URL.createObjectURL(wordBlob);
                const link = document.createElement('a');
                link.href = wordUrl;
                link.download = `${wordFileName}.docx`;
                link.click();
                URL.revokeObjectURL(wordUrl);
                pdfToWordInfo.textContent = 'Konversi selesai.';
            };

            reader.readAsArrayBuffer(file);
        }

        // Fungsi untuk mengonversi Word ke PDF
        function convertWordToPdf() {
            const fileInput = document.getElementById('word-file');
            const pdfOutputName = document.getElementById('pdf-output-name').value;
            const wordToPdfInfo = document.getElementById('word-to-pdf-info');

            if (fileInput.files.length === 0) {
                alert('Silakan pilih file Word terlebih dahulu.');
                return;
            }
            if (!pdfOutputName) {
                alert('Silakan masukkan nama file PDF.');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(event) {
                // Simulasi konversi Word ke PDF
                const wordBlob = event.target.result;
                const pdfBlob = new Blob([wordBlob], { type: 'application/pdf' });
                const pdfUrl = URL.createObjectURL(pdfBlob);
                const link = document.createElement('a');
                link.href = pdfUrl;
                link.download = `${pdfOutputName}.pdf`;
                link.click();
                URL.revokeObjectURL(pdfUrl);
                wordToPdfInfo.textContent = 'Konversi selesai.';
            };

            reader.readAsArrayBuffer(file);
        }

        // Fungsi untuk memecah file VCF
        function splitVcfFile() {
            const fileInput = document.getElementById('vcf-split-file');
            const splitCount = parseInt(document.getElementById('split-count').value, 10);
            const splitFileName = document.getElementById('split-file-name').value;
            const vcfSplitInfo = document.getElementById('vcf-split-info');

            if (fileInput.files.length === 0) {
                alert('Silakan pilih file VCF terlebih dahulu.');
                return;
            }
            if (isNaN(splitCount) || splitCount <= 0 || !splitFileName) {
                alert('Silakan masukkan jumlah kontak per file dan nama file VCF yang valid.');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(event) {
                const vcfContent = event.target.result;
                const contacts = vcfContent.split('END:VCARD').filter(card => card.trim() !== '');
                let splitContent = '';
                let fileCount = 0;

                contacts.forEach((contact, index) => {
                    splitContent += contact + 'END:VCARD\n';

                    if ((index + 1) % splitCount === 0 || index === contacts.length - 1) {
                        const splitBlob = new Blob([splitContent], { type: 'text/vcard' });
                        const splitUrl = URL.createObjectURL(splitBlob);
                        const link = document.createElement('a');
                        link.href = splitUrl;
                        link.download = `${splitFileName}_${fileCount + 1}.vcf`;
                        link.click();
                        URL.revokeObjectURL(splitUrl);

                        splitContent = '';
                        fileCount++;
                    }
                });

                vcfSplitInfo.textContent = 'Pemisahan selesai.';
            };

            reader.readAsText(file);
        }

        // Fungsi untuk mengganti nama kontak di VCF
        function editVcfContactName() {
            const fileInput = document.getElementById('vcf-edit-file');
            const newContactName = document.getElementById('new-contact-name').value;
            const editFileName = document.getElementById('edit-file-name').value;
            const vcfEditInfo = document.getElementById('vcf-edit-info');

            if (fileInput.files.length === 0) {
                alert('Silakan pilih file VCF terlebih dahulu.');
                return;
            }
            if (!newContactName || !editFileName) {
                alert('Silakan masukkan nama kontak baru dan nama file VCF.');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function(event) {
                let vcfContent = event.target.result;
                // Mengganti semua nama kontak dengan nama baru
                const regex = /FN:[^\n]*/g; // Mengganti pola 'FN:...' apapun yang ada di dalamnya
                vcfContent = vcfContent.replace(regex, `FN:${newContactName}`);

                const editedBlob = new Blob([vcfContent], { type: 'text/vcard' });
                const editedUrl = URL.createObjectURL(editedBlob);
                const link = document.createElement('a');
                link.href = editedUrl;
                link.download = `${editFileName}.vcf`;
                link.click();
                URL.revokeObjectURL(editedUrl);
                vcfEditInfo.textContent = 'Penggantian nama selesai.';
            };

            reader.readAsText(file);
        }


    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .container {
            width: 80%;
            margin: 0 auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        .file-section {
            margin-bottom: 20px;
        }
        .file-list {
            margin-top: 10px;
        }
        .file-item {
            padding: 5px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .file-item button {
            background: #f44336;
            color: #fff;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</body>
</html>
